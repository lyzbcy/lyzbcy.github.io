---
layout: post
title: "Unity插件-3D项目一键转化为VR项目"
date: 2025-11-20 08:00:00 +0800
categories: [Unity开发]
tags: [技术积累,使用说明]
description: 一款内置在Unity中的一键 VR 转换工具（VR Project Converter）使用手册 
pin: false
---
*由于我的大创项目是VR项目 但是捞鱼更熟悉3D开发 所以想着能不能做一个插件 投机取巧一下*

## 一键 VR 转换工具 - 使用手册

## 目录

- [插件简介](#插件简介)
- [适用场景](#适用场景)
- [快速开始](#快速开始)
- [界面总览](#界面总览)
- [操作流程](#操作流程)
- [功能详解](#功能详解)
- [常见问题](#常见问题)
- [注意事项与最佳实践](#注意事项与最佳实践)

---

## 插件简介

**一键 VR 转换工具（VR Project Converter）** 是 Unity 编辑器中的实用窗口，可在数分钟内把普通 Unity 项目配置为基础 VR 项目。它自动完成 XR 依赖包安装、XR Plug-in Management 配置以及场景 VR Rig 构建，帮助初学者避免手动配置的繁琐与易错。

**菜单路径**：`Tools → VR Converter → 一键转换当前项目为VR...`

---

## 适用场景

- **首次为项目加入 VR 支持**：一键拉起所有必需 XR 依赖。
- **升级旧项目**：快速启用 OpenXR 并生成 XR Origin。
- **教学/培训**：提供简洁的引导式界面，适合初学者动手实践。
- **团队规范化**：统一 XR 配置流程，减少手动步骤差异。

---

## 快速开始

1. 打开 Unity 项目，确保场景已保存。
2. 在菜单中点击 `Tools → VR Converter → 一键转换当前项目为VR...`。
3. 在窗口顶部的 **“一键执行所有步骤（推荐）”** 按钮上悬停，阅读提示后点击执行。
4. 等待 Unity 完成包导入与脚本编译，窗口日志会记录整个过程。
5. 编译结束后，如果需要，可以单独再次点击 **“执行第 2 步”** 来更新 XR 配置和场景。

---

## 界面总览

### 1. 头部信息卡

- **标题与简介**：说明工具目标及自动操作范围。
- **状态提示条**：实时显示 Unity 是否处于导入/编译状态，并提示下一步操作建议。

### 2. 快速开始卡片

- **“一键执行所有步骤（推荐）”** 按钮：带悬停提示，说明内含流程与注意事项。
- **新手提示文本**：指导首次使用者优先尝试此按钮。

### 3. 分步操作卡片

- **第 1 步：准备 XR 依赖包**  
  - 说明将检查并安装 `XR Management / OpenXR / XR Interaction Toolkit`。  
  - “执行第 1 步”按钮附带悬停提示，强调只进行依赖处理。

- **第 2 步：配置项目 & 场景**  
  - 说明会启用 OpenXR Loader，并在场景中创建/更新 XR Rig。  
  - 当 Unity 正在编译时按钮会自动禁用并给出提示，避免误操作。

### 4. 执行日志区域

- 记录所有动作的详细反馈（安装状态、配置是否成功、场景修改等）。  
- 可滚动查看，便于排障或回顾操作历史。

---

## 操作流程

### 推荐流程：一键执行

1. 点击 **“一键执行所有步骤（推荐）”**。
2. 工具会先执行第 1 步（依赖检查/安装），等待包导入。
3. 若 Unity 此时正在编译，会在日志中提示等待；编译结束后自动继续第 2 步。
4. 第 2 步包含 XR 设置配置与场景 VR Rig 构建，最后在日志中汇总结果。

### 分步操作

1. **执行第 1 步（依赖）**  
   - 只会处理 `Packages/manifest.json` 中的 XR 相关条目。  
   - 检测到 `"latest"` 占位符时会自动移除并重新安装。  
   - 安装进度实时显示在日志中。

2. **执行第 2 步（配置 + 场景）**  
   - 需要在 Unity 编译完成后点击。  
   - 会为 `Standalone` 与 `Android` 启用 OpenXR Loader，并创建/更新 XR Origin。  
   - 如 XR Interaction Toolkit 不可用，将自动退回到基础 VRRig。

---

## 功能详解

### 1. XR 依赖管理

- 检测并确保安装以下包：  
  - `com.unity.xr.management`  
  - `com.unity.xr.openxr`  
  - `com.unity.xr.interaction.toolkit`
- 自动移除 manifest 中的 `"latest"` 占位符，避免包解析失败。
- 通过 `UnityEditor.PackageManager.Client.Add` 安装缺失依赖，状态写入日志。

### 2. XR Plug-in Management 配置

- 自动创建或复用 `XRGeneralSettingsPerBuildTarget` 资产，路径：`Assets/VRConverterGenerated/XR/XRGeneralSettings.asset`。
- 为 `Standalone` 与 `Android`：  
  - 创建 `XR General Settings` 与 `XR Manager Settings`。  
  - 确保 `Init Manager On Start` 开启。  
  - 调用 `XRPackageMetadataStore.AssignLoader` 为两平台启用 `OpenXR Loader`。

### 3. 场景 VR Rig 构建

- 自动禁用旧的 `Main Camera`，防止重复渲染。
- 若检测到 `XR Interaction Toolkit`：  
  - 创建或更新 `XR Origin (Action Based)` 层级。  
  - 设置 `Camera Offset`、`Main Camera`、左右手控制器。  
  - 自动添加 `Camera`、`AudioListener`、`TrackedPoseDriver`、`ActionBasedController`、`XRRayInteractor`、`LineRenderer` 等组件。  
  - 创建 `XR Interaction Manager`、`XR Input Action Manager` 单例对象。
- 若缺少 XR Interaction 相关类型：  
  - 自动生成基础 `VRRig`，包含 `CameraOffset`、`Main Camera`、左右手占位。

### 4. 日志与提示

- 所有操作都有时间戳记录，方便回溯。
- 对常见阻塞（如 Unity 正在编译）会给出明确提示。
- 失败的包安装、XR Loader 绑定等事件会附带原因。

---

## 常见问题

**Q1：按钮灰色不可点击？**  
A：可能 Unity 正在导入/编译脚本。等待编译完成后再操作；头部状态条会同步提示当前状态。

**Q2：执行第 1 步后没有立即生效？**  
A：安装 XR 包需要时间，也可能触发脚本重编译。等编译完成后再次执行第 2 步或“一键执行”即可。

**Q3：日志提示未检测到 XR Interaction Toolkit？**  
A：请确认包已成功安装。如果暂时不可用，工具会自动使用基础 VRRig，仍可正常预览。

**Q4：OpenXR Loader 未激活？**  
A：可能是 `XRPackageMetadataStore` API 版本差异导致。请在 `Project Settings → XR Plug-in Management` 中手动确认；工具在日志里会注明绑定失败。

**Q5：场景中已有自定义 XR Rig，是否会被覆盖？**  
A：工具会检测并复用现有 `XR Origin` 或 `VRRig`。如担心冲突，建议先备份场景或使用版本控制。

**Q6：执行后出现控制台错误？**  
A：请先查看窗口日志定位到具体步骤，再结合 Unity 控制台详情排查。常见原因包括：包安装失败、脚本编译错误或场景对象被锁定。

---

## 注意事项与最佳实践

1. **使用前备份或提交**：工具会修改 manifest、项目设置与当前场景，建议提前提交到 Git 或复制场景。
2. **保持网络畅通**：安装 XR 包需要访问 Unity 包仓库。
3. **分步执行更安全**：若是生产项目，建议先手动执行第 1 步并确认依赖，再执行第 2 步。
4. **日志即帮助**：遇到异常优先查看日志区域，按提示处理可大幅降低排查时间。
5. **配合版本控制**：所有自动生成的资产保存在 `Assets/VRConverterGenerated` 下，方便追踪与回滚。

---

祝你快速拥有可运行的基础 VR 项目体验！如果还有更多需求或改进建议，欢迎反馈以便持续优化。 🚀

